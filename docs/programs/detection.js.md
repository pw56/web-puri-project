# detection.js

## detectFaces (関数)
- 概要
> 入力された画像データからTensorFlow.jsのCOCO-SSDモデルを用いて単数または複数の人物を検出し、検出した人物の信頼度(score)が0.5以上のものだけ、それぞれの人物の顔でFaceクラスのインスタンスを生成し、それらのインスタンスを配列で返す。

- 引数
> 第1引数: 検出する画像(ImageDataオブジェクト)
> 
> 例:  
> ```javascript
> ImageData //第1引数
> ```

- 返り値
> 検出された顔のインスタンス(Faceオブジェクト)が入った配列
> 
> 例:  
> ```javascript
> [Face, Face, Face...]
> ```

## Face (クラス)
- 概要
入力された顔の情報を保持、抽出するためのクラス。抽出処理にはTensorFlow.jsのFace Landmarks Detectionモデルを使用する。

> ### コンストラクタ
> - 概要
> > 入力された顔からパーツを抽出。
> > 元の画像のバウンディングボックスの範囲を、別の画像として一時ローカル変数に保存して高速化し、Face Landmarks Detectionモデルで処理。
> > インスタンス生成時にそれぞれのパーツごとにWeb Workerを用意して、事前にFace Landmarks Detectionモデルで顔のパーツを検出しておく。
> > このクラスのメソッドから返される座標は、バウンディングボックス内の座標を元の画像の座標に変換されたものである。
> > 
> - 引数
> > 第1引数: 検出元の画像(ImageDataオブジェクト)  
> > 第2引数: COCO-SSDモデルで返されたオブジェクトの対象の顔のバウンディングボックス
> > 
> > 例:  
> > ```javascript
> > ImageData, //第1引数
> > [x, y, width, height] //第2引数
> > ```
> 
> ### hasProcessed (メソッド)
> - 概要
> > 顔のパーツの検出が完了したかを返す。
> 
> - 引数
> > 第1引数: なし
> 
> - 返り値
> > 処理が完了したかを表すBool値
> > 
> > 例:  
> > ```javascript
> > true
> > ```
> 
> ### faceDeg (メソッド)
> - 概要
> > 顔の傾き(角度)を返す。
> 
> - 引数
> > 第1引数: なし
> 
> - 返り値
> > 小数を含む顔の傾きの角度(-180° ~ 180°)
> > 
> > 例:  
> > ```javascript
> > -21.865
> > ```
> 
> ### isFaceTouched (メソッド)
> - 概要
> > 入力された元の画像の座標が、このオブジェクトの保持している顔(Face Landmarks Detectionモデルで検出した顔の輪郭の内側)の範囲内かを判別する。
> 
> - 引数
> > 第1引数: 座標の配列
> >
> > 例:
> > ```javascript
> >   [20, 60]
> > ```
> 
> - 返り値
> > 入力された座標が顔に重なっているかのBool値
> > 
> > 例:  
> > ```javascript
> > true
> > ```
>
> ### contour (メソッド)
> - 概要
> > クラス内のローカル変数が保持している座標を返す。見つからなかったらエラーを返す。
> 
> - 引数
> > 第1引数: なし
> 
> - 返り値
> > 検出された顔の輪郭の座標の配列
> > 
> > 例:  
> > ```javascript
> > [[0, 0], [1, 2], [5, 8]...]
> > ```
> 
> ### eyes (メソッド)
> - 概要
> > クラス内のローカル変数が保持している左右の目の縁(目と肌の境目)の座標を、"left"と"right"のキーを持つ辞書に、左右それぞれの座標の配列を入れて返す。
> 
> - 引数
> > 第1引数: なし
> 
> - 返り値
> > 左右の目の縁の座標が入った配列を持つ辞書
> > 
> > 例:
> > ```javascript
> > {
> >   "left": [[0, 0], [1, 2], [3, 7]...]
> >   "right": [[0, 0], [1, 2], [3, 7]...]
> > }
> > ```
> 
> ### nose (メソッド)
> - 概要
> > クラス内のローカル変数が保持している鼻の縁(鼻と肌の境目)の座標を、肌と鼻の境界線の座標の配列を返す。
> 
> - 引数
> > 第1引数: なし
> 
> - 返り値
> > 鼻の縁(鼻と肌の境目)の座標の配列
> > 
> > 例:  
> > ```javascript
> > [[0, 0], [1, 2], [5, 8]...]
> > ```
