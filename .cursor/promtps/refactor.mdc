このコードをリファクタリングしてください。
外部から見た動作を変えずに内部構造を改善してください。